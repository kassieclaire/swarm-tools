{"id":"opencode-swarm-monorepo-lf2p4u-mjdado629i1","title":"Spike: SQLite + sqlite-vector as PGLite replacement","description":"PGLite is causing persistent issues:\n- Process hangs from unclosed connections\n- NOTICE spam in output\n- Complex daemon/socket architecture to work around multi-process issues\n- WAL accumulation problems\n\n**Spike goal:** Test if SQLite + sqlite-vector (https://github.com/sqliteai/sqlite-vector) could replace PGLite with less bullshit.\n\n**Requirements:**\n- Must run in Bun context (bun:sqlite)\n- Need vector similarity search for semantic memory\n- Simpler connection model (no daemon needed)\n- File-based, git-friendly\n\n**Test:**\n1. Basic CRUD with bun:sqlite\n2. sqlite-vector extension loading in Bun\n3. Vector storage and similarity search\n4. Compare DX and reliability to PGLite\n\n**Success criteria:**\n- Vectors work with reasonable perf\n- No daemon/socket complexity needed\n- Clean process exit\n- Simpler codebase\n\n**Related:** This spike should inform the @swarmtools/db package extraction (mjd1aeddf27). If SQLite works, we could:\n1. Define a clean DatabaseAdapter interface\n2. Implement SQLiteAdapter alongside PGLiteAdapter\n3. Make the adapter pluggable (env var or config)\n4. Eventually support cloud DBs (Turso, Neon, etc.)","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-19T19:52:48.794Z","updated_at":"2025-12-19T19:58:10.145Z","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjdasdw4l5b","title":"Spike: bun:sqlite + sqlite-vec vector search","description":"Quick spike to validate bun:sqlite + sqlite-vec as PGLite replacement.\n\n## Stack\n- `bun:sqlite` - Bun's native SQLite (3-6x faster than better-sqlite3)\n- `sqlite-vec` - Vector search extension by asg017 (npm install sqlite-vec)\n\n## Setup\n```typescript\nimport { Database } from \"bun:sqlite\";\nimport * as sqliteVec from \"sqlite-vec\";\n\n// MacOS needs custom SQLite for extension loading\nDatabase.setCustomSQLite(\"/usr/local/opt/sqlite3/lib/libsqlite3.dylib\");\n\nconst db = new Database(\":memory:\");\nsqliteVec.load(db);\n```\n\n## Test Cases\n1. **Basic CRUD** - Create table, insert, select, update, delete\n2. **Vector storage** - Store Float32Array embeddings\n3. **KNN search** - `WHERE embedding MATCH ? ORDER BY distance LIMIT k`\n4. **Process exit** - Verify clean exit without daemon/socket\n5. **WAL mode** - `PRAGMA journal_mode = WAL` for concurrent reads\n\n## Vector Query Pattern\n```sql\nCREATE VIRTUAL TABLE vec_memories USING vec0(\n  embedding float[1024]  -- nomic-embed-text dimension\n);\n\nINSERT INTO vec_memories(rowid, embedding) VALUES (1, ?);\n\nSELECT rowid, distance \nFROM vec_memories \nWHERE embedding MATCH ?\nORDER BY distance \nLIMIT 5;\n```\n\n## Success Criteria\n- [ ] Vectors work with Ollama embedding dimensions (1024)\n- [ ] KNN search returns correct results\n- [ ] No daemon/socket complexity\n- [ ] Clean process exit\n- [ ] Reasonable perf (don't need to beat PGLite, just not terrible)\n\n## MacOS Note\nMay need: `brew install sqlite3` for extension-capable SQLite.\n\n## Docs\n- https://alexgarcia.xyz/sqlite-vec/js.html#bun\n- https://bun.sh/docs/api/sqlite","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-19T20:04:15.316Z","updated_at":"2025-12-19T20:04:15.316Z","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjdav4u2v9w","title":"Spike: bun:sqlite + sqlite-vec with Ollama embeddings","description":"KISS spike to validate bun:sqlite + sqlite-vec works with real Ollama embeddings before investing in DatabaseAdapter rewrite.\n\n**Success criteria:**\n1. sqlite-vec loads in bun:sqlite\n2. Can store 384-dim vectors (nomic-embed-text)\n3. Can query by cosine similarity\n4. Results make semantic sense\n\n**Stack:**\n- bun:sqlite (native)\n- sqlite-vec npm package\n- Ollama for embeddings (nomic-embed-text)\n\n**Output:** Single script file that proves the concept works or documents why it doesn't.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T20:06:23.546Z","updated_at":"2025-12-19T20:15:17.897Z","closed_at":"2025-12-19T20:15:17.897Z","dependencies":[],"labels":[],"comments":[]}
